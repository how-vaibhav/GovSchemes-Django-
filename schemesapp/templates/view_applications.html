<!DOCTYPE html>
<html>
  <head>
    <title>All Applications</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
      }
      .tabs {
        margin-bottom: 20px;
      }
      .tab {
        display: inline-block;
        margin-right: 15px;
        padding: 10px 15px;
        cursor: pointer;
        background: #eee;
        border-radius: 5px;
        text-decoration: none;
        color: black;
      }
      .tab.active {
        background: #4287f5;
        color: white;
      }
      .application-card {
        border: 1px solid #ccc;
        padding: 15px;
        margin-bottom: 15px;
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      }
      .application-header {
        font-weight: bold;
        font-size: 1.2em;
        margin-bottom: 10px;
      }
      .application-detail {
        margin-bottom: 6px;
      }
      .actions button {
        margin-right: 10px;
        padding: 6px 12px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      .btn-accept {
        background-color: #4caf50;
        color: white;
      }
      .btn-reject {
        background-color: #f44336;
        color: white;
      }
      .no-applications {
        font-style: italic;
        color: #666;
      }
    </style>
  </head>
  <body>
    <h1>Submitted Applications</h1>

    <div class="tabs">
      <a
        href="?status=all"
        class="tab {% if current_filter == 'all' %}active{% endif %}"
      >
        All ({{ total_count }})
      </a>
      <a
        href="?status=pending"
        class="tab {% if current_filter == 'pending' %}active{% endif %}"
      >
        Pending ({{ pending_count }})
      </a>
      <a
        href="?status=accepted"
        class="tab {% if current_filter == 'accepted' %}active{% endif %}"
      >
        Accepted ({{ accepted_count }})
      </a>
      <a
        href="?status=rejected"
        class="tab {% if current_filter == 'rejected' %}active{% endif %}"
      >
        Rejected ({{ rejected_count }})
      </a>
    </div>

    {% if applications %} {% for app in applications %}
    <div class="application-card">
      <div class="application-header">Applicant: {{ app.user.username }}</div>
      <div class="application-detail">
        <strong>Aadhaar:</strong>
        {% if app.sensitive_data %} ********{{ app.sensitive_data|slice:"-4:" }}
        {% else %} Not Provided {% endif %}
      </div>
      <div class="application-detail">
        <strong>Scheme:</strong> {{ app.scheme.name }}
      </div>
      <div class="application-detail">
        <strong>Status:</strong> {{ app.status|capfirst }}
      </div>

      <div class="actions">
        {% if app.status == 'pending' %}
        <form
          method="post"
          action="{% url 'accept_application' app.id %}"
          style="display: inline"
        >
          {% csrf_token %}
          <button type="submit" class="btn-accept">Accept</button>
        </form>
        <form
          method="post"
          action="{% url 'reject_application' app.id %}"
          style="display: inline"
        >
          {% csrf_token %}
          <button type="submit" class="btn-reject">Reject</button>
        </form>
        {% else %}
        <em>No actions available</em>
        {% endif %}
      </div>
    </div>
    {% endfor %} {% else %}
    <p class="no-applications">No applications found.</p>
    {% endif %}
  </body>
</html>
